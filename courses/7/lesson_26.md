
# Работа с моделями и базами данных

В этом уроке мы изучим, как создавать и управлять моделями в Django, а также как взаимодействовать с базой данных.

## Шаг 1: Определение модели

Начнем с создания модели для книг. Откройте файл `models.py` в папке вашего приложения и добавьте следующий код:

```python
from django.db import models

class Book(models.Model):
    title = models.CharField(max_length=200)
    author = models.CharField(max_length=100)
    published_date = models.DateField()
    isbn = models.CharField(max_length=13, unique=True)

    def __str__(self):
        return self.title
```

### Описание кода:

- **models.Model**: Базовый класс для всех моделей в Django.
- **CharField**: Поле для хранения строковых данных.
- **DateField**: Поле для хранения даты.
- **unique=True**: Гарантирует, что значение ISBN будет уникальным в базе данных.
- **__str__()**: Метод, который возвращает строковое представление объекта.

## Шаг 2: Создание и применение миграций

После определения модели нам нужно создать миграции и применить их к базе данных. Выполните следующие команды в терминале:

```bash
python manage.py makemigrations
python manage.py migrate
```

- **makemigrations**: Создает файлы миграций на основе изменений в моделях.
- **migrate**: Применяет миграции к базе данных.

## Шаг 3: Работа с данными в базе данных

Теперь мы можем работать с данными в базе данных через Django ORM. Откройте консоль Django, выполнив команду:

```bash
python manage.py shell
```

Теперь вы можете создавать, читать, обновлять и удалять записи. Пример:

```python
from myapp.models import Book

# Создание новой книги
new_book = Book(title="Пример книги", author="Автор", published_date="2023-01-01", isbn="1234567890123")
new_book.save()

# Чтение всех книг
all_books = Book.objects.all()
print(all_books)

# Обновление книги
book_to_update = Book.objects.get(id=1)  # Получаем книгу с id=1
book_to_update.title = "Обновленное название"
book_to_update.save()

# Удаление книги
book_to_delete = Book.objects.get(id=1)
book_to_delete.delete()
```

### Описание операций:

- **create**: Создает новую запись в базе данных.
- **all()**: Получает все записи из таблицы.
- **get()**: Получает одну запись по заданному критерию.
- **save()**: Сохраняет изменения в записи.
- **delete()**: Удаляет запись из базы данных.

## Шаг 4: Использование админки Django

Django предоставляет мощный интерфейс администратора для управления моделями. Чтобы использовать его, зарегистрируйте вашу модель в `admin.py`:

```python
from django.contrib import admin
from .models import Book

admin.site.register(Book)
```

Теперь запустите сервер разработки и перейдите по адресу `http://127.0.0.1:8000/admin/`. Вам нужно будет ввести учетные данные администратора. Если у вас еще нет суперпользователя, создайте его с помощью команды:

```bash
python manage.py createsuperuser
```

## Заключение

В этом уроке мы научились создавать модели в Django, работать с базой данных через ORM и использовать админку для управления данными. Модели являются основой любого приложения на Django и позволяют эффективно управлять данными.
